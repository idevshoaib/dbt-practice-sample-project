models:
 - name: dim_listings_cleansed
   description: Cleansed table which contains Airbnb listings.
   data_tests:
    - minimum_row_count:
       arguments:
          min_row_count: 1000
      #severity: error
   columns:
    - name: listing_id
      description: Primary key for the listing
      data_tests:
       - unique
       - not_null
    
    - name: host_id
      description: The host's id. References the host table.
      data_tests:
       - not_null
       - relationships:
          arguments:
            to: ref('dim_hosts_cleansed')
            field: host_id
    
    - name: room_type
      description: Type of the apartment / room
      data_tests:
         - accepted_values:
             arguments:
               values: ['Entire home/apt',
                        'Private room',
                        'Shared room',
                        'Hotel room']
    - name: minimum_nights
      description: '{{ doc("dim_listing_cleansed__minimum_nights") }}'
      data_tests:
        - positive_values

 - name: dim_hosts_cleansed
   description: cleansed table which contains airbnb hosts.
   config:
        contract:
          enforced: true
   columns:
    - name: host_id
      description: host ID
      data_type: integer
    - name: host_name
      description: host name
      data_type: string
    - name: is_superhost
      description: host is super or not
      data_type: string
    - name: updated_at
      description: updated timestamp
      data_type: timestamp
    - name: created_at
      description: created timestamp
      data_type: timestamp